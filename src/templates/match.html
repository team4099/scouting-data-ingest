<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Match {{ match_key }}</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='water.css') }}">
</head>

<body onload="reload()">
        <div>
            <label for="scout-name">Name:</label>
            <select name="scout-name" id="NameSelect">
            </select>
        </div>
        <div>
            <label for="match">Match:</label>
            <select name="match" id="MatchSelect">
            </select>
        </div>
        <div>
            <label for="result">Outcome:</label>
            <select name="result" id="Result Select">
            </select>
        </div>
        <button id="submitChange" onclick="submitChanges()">Submit</button>
</body>


<style>
    @media screen and (min-width: 768px) {
    }
</style>
<script>
function reload(){
    var scoutsReq = new XMLHttpRequest();
    scoutsReq.onload = addOptions;
    scoutsReq.open("get", window.location.origin + "/scouts/scouts")
    scoutsReq.send()

    var matchesReq = new XMLHttpRequest();
    matchesReq.onload = addMatchOptions;
    matchesReq.open("get", window.location.origin + "/matches/upcoming")
    matchesReq.send()

}

function addOptions(){

    const info = JSON.parse(this.responseText);
    var dropdown = document.getElementById("RemoveDropdown");
    var placeholder = document.createElement("option");
    placeholder.disabled = true;
    placeholder.selected = true;
    placeholder.value = "";
    placeholder.innerText = "--";
    dropdown.replaceChildren();
    dropdown.append(placeholder);

    info["names"].forEach((name) => {
        var option = document.createElement("option");
        option.value = name;
        option.innerText = name;
        dropdown.append(option)
    })
}

function submitChanges(){
    var post = new XMLHttpRequest();
    post.open("POST", window.location.origin + "/scouts/change", false);

    post.setRequestHeader("Content-Type", "application/json");

    var data = JSON.stringify({ "add": document.getElementById("AddInput").value, "remove": document.getElementById("RemoveDropdown").value });

    document.getElementById("AddInput").value = "";
    post.send(data);
    reload('points');
}
</script>

</html>
